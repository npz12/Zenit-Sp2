<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Zenit Dashboard</title>
    <link rel="stylesheet" href="../styleMain.css">
    <link rel="stylesheet" href="../CSS/styleChart.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body>
    <div class="divHeader">
        <div class="divLogo">
            <a href="login/main.html" id="link"> <img src="../imagens/logo-1.png" alt="Logo Zenit" id="imgHeaderLogo">
            </a>
        </div>
        <a href="login/CalculadorLogin.html">
            <h4 id="liCalGanhos">Calcular Ganhos</h4>
        </a>
        <a href="login/nossoProdutoLogin.html">
            <h4 id="liNossoProduto">Nosso Produto</h4>
        </a>
        <a href="login/QuemSomosLogin.html">
            <h4 id="liQuemSomos">Quem Somos</h4>
        </a>
        <a href="dashboard.html">
            <h4 id="liDashboard">Dashboard</h4>
        </a>
        <div class="divPerfil">
            <img id="imgHeader" src="../imagens/icon-user-transparente.png" alt="">
            <h4>Perfil</h4>
            <a href="../mainZenit.html"><h4 id="liPerfil">Logout</h4></a>

            <!-- <h4 id="liPerfil"><a href='../HTML/login.html'>Log In</a></h4>
            <h4>|</h4>
            <h4 id="liPerfil"><a href='../HTML/cadastro.html'>Cadastro</a></h4> -->
        </div>

        <!-- <div class="divBarraPesquisa">
            &#8981;
            <input type="text" id="iptBarraPesquisa" placeholder="Buscar">
        </div> -->

    </div>

    
    <div id="telaModal">
            
        <div class="divContainerGrafico">

            <div id="transformadoresTotais" style="display: block;">
                <!-- <h1>Visão geral dos transformadores</h1> -->
                <div class="grafico">
                    <canvas id="graficoVisaoAmpla" width="800px"></canvas>
                </div>
            </div>

            <div id="transformadorUm" style="display: none;">
                <!-- <h1>Transformador 1</h1> -->
                <div class="grafico">
                    <canvas id="graficoVisaoDetalhada" width="800px"></canvas>
                </div>
            </div>


            <button onclick="mostrarTransformadorUm()" id="buttonVisaoIndividual" class="buttonGrafico">Visão
                transformador 1</button>
            <button onclick="mostrarVisaoGeral()" style="display: none;" id="buttonVisaoGeral"
                class="buttonGrafico">Visão geral dos
                transformadores</button>

        </div>
        <div class="divKPI" id="divKpiGeral">
            
            <div class="miniKPI">
                <canvas id="graficoKpiGeral" width="200px"></canvas>
            </div>
            <div class="miniKPI" id="caixaUm">
                <span id="kpiCritico">0</span>
                <p>Critico</p>          
            </div>
            
            <div class="miniKPI" id="caixaDois">
                <span id="kpiAlerta">0</span>
                <p>Alerta</p>
            </div>
            
        </div>

        <div class="divKPI" id="divKpiIndividual" style="display: none;">
            
            <div class="miniKPI" id="maiorTemperatura">
                <span id="kpiMaior">0</span>
                <p>Temperatura mais alta <br> nas ultimas 12 horas</p>
            </div>
            <div class="miniKPI" id="menorTemperatura">
                <span id="kpiMenor">0</span>
                <p>Temperatura mais baixa <br> nas ultimas 12 horas</p>

            </div>
            
            <div class="miniKPI" id="mediaTemperatura">
                <span id="kpiMedia">0</span>
                <p>Temperatura média <br> nas ultimas 12 horas</p>
            </div>
            
        </div>
    </div>

    <div class="divFooter">
        <div class="content">
            <img src="../imagens/logo-1.png" alt="Logo Footer" id="imgFooterLogo">
            <div class="divColuna">  
                <h5>INÍCIO</h5>    
                <ul id="listaFooterHome">
                    <li><a href="login/main.html"> Home </a></li>
                    <li><a href="login.html"> Log in </a></li>
                    <li><a href=""> Blog </a></li>
                    <li><a href="">  </a></li>
                </ul>    
            </div>
            <div class="divColuna">  
                <h5>FALE CONOSCO</h5>    
                <ul id="listaFooterFaleConosco">
                    <li><a href="login/nossoProdutoLogin.html"> Informações da Empresa </a></li>
                    <li><a href=""> Contrate Nosso Serviço </a></li>
                    <li><a href="login/QuemSomosLogin.html"> Sobre nós </a></li>
                </ul>    
            </div>
            <div class="divColuna">
                <h5>SUPORTE</h5> 
                <ul id="listaFooterSuporte">
                    <li><a href=""> FAQ </a></li>
                    <li><a href=""> Central de ajuda </a></li>
                </ul>
            </div>
            <div class="divColunaRedes">
                <a href="https://www.instagram.com/"><img src="../imagens/instagram-icon.svg" alt="icon - instagram" id="iconsFooter"></a>
                <a href="https://www.linkedin.com"><img src="../imagens/linkedin-icon.svg" alt="icon - linkedin" id="iconsFooter"></a>
                <a href="https://github.com/Zenit-Sp2/Zenit-Sp2.git"><img src="../imagens/github-icon-footer.svg" alt="icon - github" id="iconsFooter"></a>    
            </div>
        </div>

        <div id="zenitFooter"><h4>© 2023 Copyright Zenit</h4></div>
</body>

</html>
<script>

    function mostrarTransformadorUm() {
        transformadorUm.style = 'width: 800px; display: block;';
        transformadoresTotais.style = 'width: 0; display: none;';
        buttonVisaoGeral.style.display = 'block';
        buttonVisaoIndividual.style.display = 'none';
        divKpiIndividual.style.display = 'flex';
        divKpiGeral.style.display = 'none';

    }

    function mostrarVisaoGeral() {
        transformadorUm.style = 'width: 0; display: none;';
        transformadoresTotais.style = 'width: 800px; display: block;';
        buttonVisaoGeral.style.display = 'none';
        buttonVisaoIndividual.style.display = 'block';
        divKpiIndividual.style.display = 'none';
        divKpiGeral.style.display = 'flex';

    }

    const visaoAmpla = document.getElementById('graficoVisaoAmpla');
    const visaoDetalhada = document.getElementById('graficoVisaoDetalhada');
    const kpiGeral = document.getElementById('graficoKpiGeral');
    const kpiIndividual = document.getElementById('graficoKpiIndividual'); 

    var ideal = 0;
    var alerta = 0;
    var critico = 0;

    var menorTemp = 1000;
    var maiorTemp = 0;
    var tempMedia = 0;
    
    // VG = visao geral
    var dadosVG = [80, 86, 105, 120, 77, 82, 48, 80, 76, 10, 31, 84, 80]

    // VI = visao individual
    var dadosVI = [80, 90, 100, 95, 87, 82, 88, 80, 76, 70, 81, 83, 84];
    
    // 
    var dadosKpi = [0,0,0];
    for (var i = 0; i < 13; i++) {
        if (dadosVG[i] >= 45 && dadosVG[i] <= 80) {
            dadosKpi[0]++;
        }
        
        if (dadosVG[i] >= 20 && dadosVG[i] < 45 || dadosVG[i] > 80 && dadosVG[i] < 100){
            dadosKpi[1]++;
        }
        
        if (dadosVG[i] >= 100 || dadosVG[i] < 20) {
            dadosKpi[2]++;
        }

    }


    // calculando menor temperatura, maior temperatura e temperatura media
    for (var i = 0 ; i < 13 ; i++){
        if(dadosVI[i] < menorTemp){
            menorTemp = dadosVI[i]
        }
        if(dadosVI[i] > maiorTemp){
            maiorTemp = dadosVI[i]
        }
        tempMedia += dadosVI[i];
    }

    tempMedia = tempMedia / 13;
    
    kpiMaior.innerHTML = maiorTemp;
    kpiMenor.innerHTML = menorTemp;
    kpiMedia.innerHTML = tempMedia.toFixed(0);

    kpiAlerta.innerHTML = dadosKpi[1];
    kpiCritico.innerHTML = dadosKpi[2];


    Chart.defaults.color = "#000";

    new Chart(visaoAmpla, {
        type: 'bar',
        data: {
            labels: ['1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '11', '12', '13'],
            datasets: [{
                label: 'Temperatura( °C ) 21:00',
                data: dadosVG,
                borderWidth: 1,
                backgroundColor: ["#1770B9"]
            },
            ]
        },
        options: {
            plugins: {
                legend: {
                    labels: {
                        font: {
                            size: 25
                        }
                    },
                    title: {
                        font: {
                            size: 40
                        },
                        display: true,
                        text: 'Visão geral dos transformadores',
                    },
                }
            },
            scales: {
                y: {
                    grid: {
                        color: '#636363'
                    },
                    beginAtZero: true,
                    title: {
                        display: true,
                        text: 'Temperatura'
                    }
                },
                x: {
                    grid: {
                        display: false
                    },
                    title: {
                        display: true,
                        text: 'Identificão do transformador'
                    }
                }
            }
        }
    });

    new Chart(visaoDetalhada, {
        type: 'line',
        data: {
            labels: ['09:00', '10:00', '11:00', '12:00', '13:00', '14:00', '15:00', '16:00', '17:00', '18:00', '19:00', '20:00', '21:00'],
            datasets: [{
                label: 'Temperatura( °C ) 22/11/2022',
                // label: 'Ideal',
                data: dadosVI,
                borderWidth: 5,
                borderColor: "#4472c4",
                backgroundColor: "#4472c4"
            },]
        },
        options: {
            plugins: {
                legend: {
                    labels: {
                        font: {
                            size: 25
                        }
                    },
                    title: {
                        font: {
                            size: 40
                        },
                        display: true,
                        text: 'Transformador: 1',
                    },
                }
            },
            scales: {
                y: {
                    grid: {
                        color: '#636363'
                    },
                    beginAtZero: false,
                    title: {
                        display: true,
                        text: 'Temperatura'
                    }
                },
                x: {
                    grid: {
                        display: true,
                        color: '#636363'
                    },
                    title: {
                        display: true,
                        text: 'Horário'
                    }
                }
            }
        }
    });

    new Chart(kpiGeral, {
        type: 'pie',
        data: {
            labels: [`Ideal(${dadosKpi[0]})`, `Alerta(${dadosKpi[1]})`, `Critico(${dadosKpi[2]})`],
            datasets: [{
                // label: 'Ideal',
                label: 'Temperatura( °C ) 21:00',
                data: dadosKpi,
                borderWidth: 1,
                borderColor: "#fff",
                backgroundColor: ["#44ff44", "#ffff44", "#ff4444"]
            }]
        },
        options: {
            plugins: {
                legend: {
                    labels: {
                        font: {
                            size: 10
                        }
                    },
                    title: {
                        display: true,
                        text: 'Indicadores'
                    },
                }
            },
            scales: {
                // y: {
                //     grid: {
                //         display: false,
                //     },
                //     beginAtZero: false,
                //     title: {
                //         display: false,
                //         text: 'Temperatura'
                //     }
                // },
                // x: {
                //     grid: {
                //         display: false
                //     },
                //     title: {
                //         display: true,
                //         text: 'Identificão do transformador'
                //     }
                // }
            }
        }
    });


</script>