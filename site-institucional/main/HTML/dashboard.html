<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Zenit Dashboard</title>
    <link rel="stylesheet" href="../styleMain.css">
    <link rel="stylesheet" href="../CSS/styleChart.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body>
    <div class="divHeader">
        <div class="divLogo">
            <a href="../mainZenit.html" id="link"> <img src="../imagens/logo-1.png" alt="Logo Zenit" id="imgHeaderLogo">
            </a>
        </div>
        <a href="../HTML/Calculador.html">
            <h4 id="liCalGanhos">Calcular Ganhos</h4>
        </a>
        <a href="../HTML/nossoProduto.html">
            <h4 id="liNossoProduto">Nosso Produto</h4>
        </a>
        <a href="../HTML/QuemSomos.html">
            <h4 id="liQuemSomos">Quem Somos</h4>
        </a>
        <div class="divPerfil">
            <img id="imgHeader" src="../imagens/icon-user-transparente.png" alt="">
            <h4>Perfil</h4>
            <!-- <h4 id="liPerfil"><a href='../HTML/login.html'>Log In</a></h4>
            <h4>|</h4>
            <h4 id="liPerfil"><a href='../HTML/cadastro.html'>Cadastro</a></h4> -->
        </div>

        <!-- <div class="divBarraPesquisa">
            &#8981;
            <input type="text" id="iptBarraPesquisa" placeholder="Buscar">
        </div> -->

    </div>


    <div id="telaModal">
        
        <div class="divContainerGrafico">

            <div id="transformadoresTotais" style="display: block;">
                <!-- <h1>Visão geral dos transformadores</h1> -->
                <div class="grafico">
                    <canvas id="graficoVisaoAmpla" width="800px"></canvas>
                </div>
            </div>

            <div id="transformadorUm" style="display: none;">
                <!-- <h1>Transformador 1</h1> -->
                <div class="grafico">
                    <canvas id="graficoVisaoDetalhada" width="800px"></canvas>
                </div>
            </div>

            <!-- <div id="metricas">cc</div> -->

            <button onclick="mostrarTransformadorUm()" id="buttonVisaoIndividual" class="buttonGrafico">Visão
                transformador 1</button>
            <button onclick="mostrarVisaoGeral()" style="display: none;" id="buttonVisaoGeral"
                class="buttonGrafico">Visão geral dos
                transformadores</button>
            <!-- <span class="buttonGrafico">
                    <button onclick="expVisaoAmpla()">Visão ampla</button>
                    <button onclick="expTransformador()">Transformador 1</button>
                </span> -->
        </div>
        <div class="divKPI">
            <div class="miniKPI">
                <canvas id="graficoKpiGeral" width="200px"></canvas>
            </div>

            <div class="miniKPI">
                
            </div>

            <div class="miniKPI">

            </div>
        </div>
    </div>

    <div class="divFooter">
        <div class="content">
            <img src="../imagens/logo-1.png" alt="Logo Footer" id="imgFooterLogo">
            <div class="divColuna">
                <p>Lorem ipsum dolor sit amet consectetur adipisicing elit. In qui tempore aut voluptate obcaecati
                    exercitationem nihil, aspernatur</p>
            </div>
            <div class="divColuna">
                <p>Lorem ipsum dolor sit amet consectetur adipisicing elit. In qui tempore aut voluptate obcaecati
                    exercitationem nihil, aspernatur</p>
            </div>
            <div class="divColuna">
                <p>Lorem ipsum dolor sit amet consectetur adipisicing elit. In qui tempore aut voluptate obcaecati
                    exercitationem nihil, aspernatur</p>
            </div>
        </div>
</body>

</html>
<script>

    function mostrarTransformadorUm() {
        transformadorUm.style = 'width: 800px; display: block;';
        transformadoresTotais.style = 'width: 0; display: none;';
        buttonVisaoGeral.style.display = 'block';
        buttonVisaoIndividual.style.display = 'none';

    }

    function mostrarVisaoGeral() {
        transformadorUm.style = 'width: 0; display: none;';
        transformadoresTotais.style = 'width: 800px; display: block;';
        buttonVisaoGeral.style.display = 'none';
        buttonVisaoIndividual.style.display = 'block';

    }

    const visaoAmpla = document.getElementById('graficoVisaoAmpla');
    const visaoDetalhada = document.getElementById('graficoVisaoDetalhada');
    const kpiGeral = document.getElementById('graficoKpiGeral');
    const kpiIndividual = document.getElementById('graficoKpiIndividual');

    var ideal = 0;
    var alerta = 0;
    var critico = 0;
    
    var listaIdeal = [];
    var listaAlerta = [];
    var listaCritico = [];
    var dadosLM35 = [80, 86, 105, 120, 77, 82, 48, 80, 76, 10, 31, 84, 80]
    for (var i = 0; i < 3; i++) {
        
        for (var j = 0; j < 13; j++) {
            if (i == 0 && (dadosLM35[j] >= 45 && dadosLM35[j] <= 80)) {
                listaIdeal[ideal] = j + 1;
                ideal++;
                // console.log(`ideal(${i}): ${j} (${dadosLM35[j]})`)
            }
            
            if (i == 1 && (dadosLM35[j] >= 20 && dadosLM35[j] < 45 || dadosLM35[j] > 80 && dadosLM35[j] < 100)) {
                listaAlerta[alerta] = j + 1;
                alerta++;
                // console.log(`alerta(${i}): ${j} (${dadosLM35[j]})`)
            }
            
            if (i == 2 && (dadosLM35[j] >= 100 || dadosLM35[j] < 20)) {
                listaCritico[critico] = j + 1;
                critico++;
                // console.log(`critico(${i}): ${j} (${dadosLM35[j]})`)
            }
        }
        
    }
    console.log(`lista ideal: ${listaIdeal} lista alerta: ${listaAlerta} lista critico: ${listaCritico}`)

    var dados = [ideal, alerta, critico];


    Chart.defaults.color = "#000";

    new Chart(visaoAmpla, {
        type: 'bar',
        data: {
            labels: ['1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '11', '12', '13'],
            datasets: [{
                label: 'Temperatura( °C ) 21:00',
                data: dadosLM35,
                borderWidth: 1,
                backgroundColor: ["#1770B9"]
            },
            ]
        },
        options: {
            plugins: {
                legend: {
                    labels: {
                        font: {
                            size: 25
                        }
                    },
                    title: {
                        font: {
                            size: 40
                        },
                        display: true,
                        text: 'Visão geral dos transformadores',
                    },
                }
            },
            scales: {
                y: {
                    grid: {
                        color: '#636363'
                    },
                    beginAtZero: true,
                    title: {
                        display: true,
                        text: 'Temperatura'
                    }
                },
                x: {
                    grid: {
                        display: false
                    },
                    title: {
                        display: true,
                        text: 'Identificão do transformador'
                    }
                }
            }
        }
    });

    new Chart(visaoDetalhada, {
        type: 'line',
        data: {
            labels: ['09:00', '10:00', '11:00', '12:00', '13:00', '14:00', '15:00', '16:00', '17:00', '18:00', '19:00', '20:00', '21:00'],
            datasets: [{
                label: 'Temperatura( °C ) 22/11/2022',
                // label: 'Ideal',
                data: [80, 90, 100, 95, 87, 82, 88, 80, 76, 70, 81, 83, 84],
                borderWidth: 5,
                borderColor: "#4472c4",
                backgroundColor: "#4472c4"
            },]
        },
        options: {
            plugins: {
                legend: {
                    labels: {
                        font: {
                            size: 25
                        }
                    },
                    title: {
                        font: {
                            size: 40
                        },
                        display: true,
                        text: 'Transformador: 1',
                    },
                }
            },
            scales: {
                y: {
                    grid: {
                        color: '#636363'
                    },
                    beginAtZero: false,
                    title: {
                        display: true,
                        text: 'Temperatura'
                    }
                },
                x: {
                    grid: {
                        display: true,
                        color: '#636363'
                    },
                    title: {
                        display: true,
                        text: 'Horário'
                    }
                }
            }
        }
    });

    new Chart(kpiGeral, {
        type: 'pie',
        data: {
            labels: [`Ideal(${dados[0]})`, `Alerta(${dados[1]})`, `Critico(${dados[2]})`],
            datasets: [{
                // label: 'Ideal',
                label: 'Temperatura( °C ) 21:00',
                data: dados,
                borderWidth: 1,
                borderColor: "#fff",
                backgroundColor: ["#44ff44", "#ffff44", "#ff4444"]
            }]
        },
        options: {
            plugins: {
                legend: {
                    labels: {
                        font: {
                            size: 10
                        }
                    },
                    title: {
                        display: true,
                        text: 'Indicadores'
                    },
                }
            },
            scales: {
                // y: {
                //     grid: {
                //         display: false,
                //     },
                //     beginAtZero: false,
                //     title: {
                //         display: false,
                //         text: 'Temperatura'
                //     }
                // },
                // x: {
                //     grid: {
                //         display: false
                //     },
                //     title: {
                //         display: true,
                //         text: 'Identificão do transformador'
                //     }
                // }
            }
        }
    });


</script>