<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Meus endereços</title>
    <link rel="stylesheet" href="../css/style.css">
    <link rel="stylesheet" href="../css/styleAddress.css">
    <link rel="stylesheet" href="../css/styleCadastro.css">
    <link rel="stylesheet" href="../css/Zstyle.css">
</head>

<body>
    <div class="divHeader">
        <div class="divLogo">
            <a href="main.html" id="link"> <img src="../assets/imgs/logo-1.png" alt="Logo Zenit" id="imgHeaderLogo">
            </a>
        </div>
        <a href="CalculadorLogin.html">
            <h4 class="liHeader">Calcular Ganhos</h4>
        </a>
        <a href="nossoProdutoLogin.html">
            <h4 class="liHeader">Nosso Produto</h4>
        </a>
        <a href="QuemSomosLogin.html">
            <h4 class="liHeader">Quem Somos</h4>
        </a>
        <a href="dashboard.html">
            <h4 class="liHeader">Dashboard</h4>
        </a>
        <div class="divPerfil">
            <img id="imgHeader" src="../assets/imgs/icon-user-transparente.png" alt="">
            <a href="perfil.html">
                <h4 id="liPerfil">Perfil |</h4>
            </a>
            <a href="../index.html">
                <h4 id="liPerfil"> Logout</h4>
            </a>
        </div>
    </div>
    <!-- Final Header-->
    <div class="alerta_erro">
        <div class="card_erro" id="cardErro">
            <span id="mensagem_erro"></span>
        </div>
    </div>
    <div class="divCadastro" id="telaCadastro">
        <h2 class="h1Titulo">Cadastro de endereço</h2>
        <input type="text" placeholder="Rua" id="inptRua">
        <span class="mensagem-de-erro">
            <span id="span_erro_caractere_especial_nome">*Nome não deve conter caracteres <br> especiais e
                números</span>
        </span>
        <input type="text" placeholder="Bairro" id="inptBairro">

        <input type="number" placeholder="Número" id="inptNumero">

        <input type="text" placeholder="Cidade" id="inptCidade">

        <input type="text" placeholder="Complemento" id="inptComplemento">

        <input type="text" placeholder="CEP" id="inptCEP">

        <button class="btnCadastro" onclick="cadastrar()">Cadastrar</button>


    </div>
    <!-- Layout para listar funcionario
    <div class="container">
        <div class="mainInfo"></div>
        <div class="mainColumn">
            <span class="profileText">Rua</span>
            <span class="profileText">Bairro</span>
            <span class="profileText">Cidade</span>
            <span class="profileText">CEP</span>
            <span class="profileText">Número</span>
            <span class="profileText">Complemento</span>
        </div>
        <div class="mainColumn1">
            <span id="RuaAtual" class="profileText"></span>
            <span id="BairroAtual" class="profileText"></span>
            <span id="CidadeAtual" class="profileText"></span>
            <span id="CEPAtual" class="profileText"></span>
            <span id="NumeroAtual" class="profileText"></span>
            <span id="ComplementoAtual" class="profileText"></span>
        </div>
    </div>
    -->
    <!--Inicio Footer -->
    <div class="divFooter">
        <div class="content">
            <img src="../assets/imgs/logo-1.png" alt="Logo Footer" id="imgFooterLogo">
            <div class="divColuna">  
                <h5>INÍCIO</h5>    
                <ul id="listaFooterHome">
                    <li><a href="main.html"> Home </a></li>
                    <li><a href="dashboard.html"> Dashboard </a></li>
                    <li><a href="cadastrarFuncionario.html"> Cadastrar Funcionário </a></li>
                    <li><a href="perfil.html"> Perfil </a></li>
                </ul>    
            </div>
            <div class="divColuna">  
                <h5>FALE CONOSCO</h5>    
                <ul id="listaFooterFaleConosco">
                    <li><a href="nossoProdutoLogin.html"> Informações da Empresa </a></li>
                    <li><a href="QuemSomosLogin.html"> Sobre nós </a></li>
                </ul>    
            </div>
            <div class="divColuna">
                <h5>SUPORTE</h5> 
                <ul id="listaFooterSuporte">
                    <li><a href="https://mail.google.com"> Zeniteletrica@gmail.com </a></li>
                    <li><a href="https://zeniteletrica.atlassian.net/servicedesk/customer/portal/1"> Central de ajuda </a></li>
                </ul>
            </div>
            <div class="divColunaRedes">
                <a href="https://www.instagram.com/"><img src="../assets/imgs/instagram-icon.svg" alt="icon - instagram" class="iconsFooter"></a>
                <a href="https://www.linkedin.com"><img src="../assets/imgs/linkedin-icon.svg" alt="icon - linkedin" class="iconsFooter"></a>
                <a href="https://github.com/npz12/Zenit-Sp2.git"><img src="../assets/imgs/github-icon-footer.svg" alt="icon - github" class="iconsFooter"></a>    
            </div>
        </div>

        <div id="zenitFooter"><h4>© 2023 Copyright Zenit</h4></div>
    </div>
</body>

</html>
<script>
    var fkEmpresa = sessionStorage.ID_EMPRESA;
    function cadastrar() {

        var varRua = inptRua.value;
        var varBairro = inptBairro.value;
        var varNumero = inptNumero.value;
        var varCidade = inptCidade.value;
        var varCEP = inptCEP.value;
        var varComplemento = inptComplemento.value;

        if (varRua == '' || varNumero == '' || varCidade == '' || varCEP == '') {

            cardErro.style.display = "block"

            mensagem_erro.innerHTML = "Verifique se o campo Endereço, Número, Cidade e CEP foram preenchidos";

            setInterval(() => {
                cardErro.style.display = "none"
            }, 5000)
        }
        else if(varRua.length < 5){
            cardErro.style.display = "block"

            mensagem_erro.innerHTML = "O campo rua deve ter ao menos 5 caracteres";

            setInterval(() => {
                cardErro.style.display = "none"
            }, 5000)
        }
        else if(varBairro.length < 3){
            cardErro.style.display = "block"

            mensagem_erro.innerHTML = "O campo bairro deve ter ao menos 3 caracteres";

            setInterval(() => {
                cardErro.style.display = "none"
            }, 5000)
        }
        else if(varCidade.length < 5){
            cardErro.style.display = "block"

            mensagem_erro.innerHTML = "O campo cidade deve ter ao menos 5 caracteres";

            setInterval(() => {
                cardErro.style.display = "none"
            }, 5000)
        }
        else if(varCEP.length != 9){
            cardErro.style.display = "block"

            mensagem_erro.innerHTML = "O campo CEP deve ter 9 caracteres contando com o '-'";

            setInterval(() => {
                cardErro.style.display = "none"
            }, 5000)
        }
        
        else {
            fetch("/usuarios/EmpresaNewEndereco", {
                method: "POST",
                headers: {
                    "Content-type": "application/json"
                },
                body: JSON.stringify({
                    RuaServer: varRua,
                    BairroServer: varBairro,
                    NumeroServer: varNumero,
                    CidadeServer: varCidade,
                    CEPServer: varCEP,
                    ComplementoServer: varComplemento,
                    fkEmpresaServer: fkEmpresa
                })
            }).then(function (resposta) {
                console.log("resposta:", resposta);
                if (resposta.ok) {
                    mensagem_erro.innerHTML = `Cadastro realizado com sucesso, redirecionando para tela de perfil`;
                    setTimeout(() => {
                        window.location = 'perfil.html';
                    }, 3000);
                } else {
                    throw (`Houve um erro ao realizar o cadastro!`)
                }
            }).catch(function (resposta) {
                console.log(`#ERRO: ${resposta}`);

            })
            return false;
        }

    }
</script>